@(competition: mcgrady.model.Competition, countries:Seq[mcgrady.model.Country], teams:Seq[mcgrady.model.Team],inscriptions:Seq[mcgrady.model.Inscription], games:Seq[mcgrady.model.Game],tStats:Seq[mcgrady.model.TeamStats],players:Seq[mcgrady.model.Player],pStats:Seq[mcgrady.model.PlayerStats])(implicit flash: play.api.mvc.Flash,request: RequestHeader,messages : Messages)
@import java.math.BigInteger; var tWins=0; var tLoses=0; var tGames=0; var pGames=0; var pPts=0; var pReb=0; var pAss=0; var pBlk=0; var pSte=0;
@sum(a:Long,b:Long) = {@(a + b).toInt}
@div(a:Long,b:Long) = {@(a / b)}
@main(Messages("competition.title")){
<h3>@competition.name</h3>
<div id="standings">
    <table id="table-standings" class="table table-striped">
        <tr>
            <th onclick="sortTable(0,'table-standings')">Nombre</th>
            <th onclick="sortTable(1,'table-standings')">Partidos</th>
            <th onclick="sortTable(2,'table-standings')">V - D</th>
        </tr>
        @for(inscription<-inscriptions){ @if(inscription.idCompetition == competition.id.get){
        @for(team<-teams){ @if(team.id.get == inscription.idTeam){ @{tGames=0} @{tWins=0} @{tLoses=0}
        <tr>
            <td>@team.name</td>
            @for(game<-games){
            @if(game.idHome == inscription.idTeam){ @{tGames += 1}
                @if(game.winner.get == "H"){ @{tWins += 1} }else{ @{tLoses += 1} }
            }else{
                @if(game.idVisitor == inscription.idTeam){ @{tGames += 1}
                    @if(game.winner.get == "A"){ @{tWins += 1} }else{ @{tLoses += 1} }
                }
            }}
            <td>@tGames</td>
            <td>@tWins - @tLoses</td>
        </tr>
        }}}}
    </table>
</div>
<br>
<div id="stats">
    <table id="table-stats" class="table table-striped table-inline">
        <tr><th onclick="sortTable(0,'table-stats')">Jugador</th>
        <th onclick="sortTable(1,'table-stats')">Puntos PP</th>
        <th onclick="sortTable(2,'table-stats')">Rebotes PP</th>
        <th onclick="sortTable(3,'table-stats')">Aistencias PP</th>
        <th onclick="sortTable(4,'table-stats')">Robos PP</th>
        <th onclick="sortTable(5,'table-stats')">Tapones PP</th>
        <th onclick="sortTable(6,'table-stats')">Partidos</th></tr>
        @for(player<-players){
        @{pGames=0} @{pPts=0} @{pReb=0} @{pAss=0} @{pSte=0} @{pBlk=0}
        @for(game<-games){ @for(inscription<-inscriptions){
        @if(game.idHome == inscription.idTeam && inscription.idCompetition == competition.id.get){
        @for(pStat<-pStats){ @if(pStat.idGame == game.id.get){ @if(player.id.get == pStat.idPlayer){
        @{pGames+=1}
        @{pPts+=pStat.points.get.asInstanceOf[Number].intValue}
        @{pReb+=pStat.offReb.get.asInstanceOf[Number].intValue+pStat.defReb.get.asInstanceOf[Number].intValue}
        @{pAss+=pStat.assists.get.asInstanceOf[Number].intValue}
        @{pBlk+=pStat.blocks.get.asInstanceOf[Number].intValue}
        @{pSte+=pStat.steals.get.asInstanceOf[Number].intValue}
        }}}}}}
        <tr>
            <td>@player.firstName @player.lastName</td>
            <td>@{"%.2f".format(pPts.toFloat/pGames.toFloat).replace(',','.')}</td>
            <td>@{"%.2f".format(pReb.toFloat/pGames.toFloat).replace(',','.')}</td>
            <td>@{"%.2f".format(pAss.toFloat/pGames.toFloat).replace(',','.')}</td>
            <td>@{"%.2f".format(pSte.toFloat/pGames.toFloat).replace(',','.')}</td>
            <td>@{"%.2f".format(pBlk.toFloat/pGames.toFloat).replace(',','.')}</td>
            <td>@pGames</td>
        </tr>
        }
    </table>
</div>
}